# Generated and Configuration Files

This document describes all generated files, configuration files, and hidden files used in the tutorial. These files are created during setup, deployment, or runtime and should generally not be committed to version control.

## File Overview

**Note:** All files listed below are in `.gitignore` and should never be committed to version control.

| File | Location | Purpose | Generated By |
|------|----------|---------|--------------|
| `.env` | Tutorial root | Environment variables for local development | Manual/User |
| `.bedrock_agentcore.yaml` | Tutorial root | AgentCore Runtime configuration cache | bedrock-agentcore-starter-toolkit |
| `.deployment_metadata.json` | `scripts/` | Deployment information (agent ID, ARN, etc.) | `deploy_agent.py` |
| `.env.backup` | `scripts/` | Backup of previous .env file | `setup_braintrust.sh` |
| `Dockerfile` | Tutorial root | Docker container definition | bedrock-agentcore-starter-toolkit |
| `.dockerignore` | Tutorial root | Docker build exclusions | bedrock-agentcore-starter-toolkit |

## Detailed File Descriptions

---

### `.env`
**Location:** Tutorial root (`simple-dual-observability/.env`)

**Purpose:** Stores environment variables for local development and deployment, including AWS region and optional Braintrust credentials.

**Generated By:** Manual creation by user or copied from example template

**Typical Contents:**
```bash
# AWS Configuration
AWS_REGION=us-east-1

# Braintrust Configuration (optional)
BRAINTRUST_API_KEY=bt-xxxxxxxxxxxxxxxxxxxxxxxx
BRAINTRUST_PROJECT_ID=your-project-id
```

**Usage:**
- Automatically loaded by `setup_all.sh` script
- Used by deployment scripts to configure agent
- Credentials are read from this file if not provided via command-line arguments

**Important Notes:**
- **NEVER commit this file** - it contains sensitive API keys
- Listed in `.gitignore` to prevent accidental commits
- Create from `.env.example` template if one exists
- Keep API keys secure and rotate them regularly

---

### `.bedrock_agentcore.yaml`
**Location:** Tutorial root (`simple-dual-observability/.bedrock_agentcore.yaml`)

**Purpose:** Caches AgentCore Runtime configuration and state to speed up subsequent deployments and avoid recreating resources unnecessarily.

**Generated By:** `bedrock-agentcore-starter-toolkit` during first `Runtime.configure()` call

**Typical Contents:**
```yaml
agent_name: weather_time_observability_agent
region: us-east-1
entrypoint: agent/weather_time_agent.py
requirements_file: requirements.txt
auto_create_execution_role: true
auto_create_ecr: true
disable_otel: false  # or true if Braintrust is enabled
# ... other configuration options
```

**Usage:**
- Read by the toolkit on subsequent deployment runs
- Allows the toolkit to remember previous configuration
- Speeds up deployment by reusing existing resources

**Important Notes:**
- Auto-generated on first deployment
- Safe to delete - will be regenerated on next deployment
- Listed in `.gitignore`
- Contains deployment state, not secrets

---

### `.deployment_metadata.json`
**Location:** `scripts/.deployment_metadata.json`

**Purpose:** Single source of truth for deployment information. Contains agent ID, ARN, ECR URI, region, and configuration flags. Used by all scripts to identify and interact with the deployed agent.

**Generated By:** `scripts/deploy_agent.py` after successful deployment

**Typical Contents:**
```json
{
  "agent_id": "weather_time_observability_agent-dWTPGP46D4",
  "agent_arn": "arn:aws:bedrock-agentcore:us-east-1:123456789012:agent-runtime/weather_time_observability_agent-dWTPGP46D4",
  "ecr_uri": "123456789012.dkr.ecr.us-east-1.amazonaws.com/weather_time_observability_agent",
  "region": "us-east-1",
  "agent_name": "weather_time_observability_agent",
  "braintrust_enabled": true
}
```

**Usage:**
- Read by `test_agent.py`, `test_agent.sh` to invoke the agent
- Read by `cleanup.sh` to delete resources
- Read by `simple_observability.py` to detect Braintrust configuration
- Read by `setup_all.sh` to display deployment information

**Important Notes:**
- Created during deployment
- Deleted during cleanup
- Listed in `.gitignore`
- This is the **only** metadata file needed (replaces legacy `.agent_id` and `.env` files)
- Must exist for scripts to work - if missing, redeploy the agent

**Generation Process:**
```python
# In deploy_agent.py
deployment_info = {
    "agent_id": launch_result.agent_id,
    "agent_arn": launch_result.agent_arn,
    "ecr_uri": launch_result.ecr_uri,
    "region": region,
    "agent_name": agent_name,
    "braintrust_enabled": enable_braintrust
}
metadata_file.write_text(json.dumps(deployment_info, indent=2))
```

---

### `.env.backup`
**Location:** `scripts/.env.backup`

**Purpose:** Backup of previous `.env` file created when `setup_braintrust.sh` updates environment variables.

**Generated By:** `scripts/setup_braintrust.sh` when adding Braintrust credentials

**Typical Contents:**
Same format as `.env` file (previous version)

**Usage:**
- Allows recovery of previous configuration if needed
- Created only if `.env` already exists when running setup

**Important Notes:**
- Listed in `.gitignore`
- Contains sensitive information - do not commit
- Can be safely deleted after verifying new configuration works

**Generation Process:**
```bash
# In setup_braintrust.sh
if [ -f "$SCRIPT_DIR/.env" ]; then
    cp "$SCRIPT_DIR/.env" "$SCRIPT_DIR/.env.backup"
fi
```

---

### `Dockerfile`
**Location:** Tutorial root (`simple-dual-observability/Dockerfile`)

**Purpose:** Defines the Docker container image for the agent, including Python environment, dependencies, and startup command.

**Generated By:** `bedrock-agentcore-starter-toolkit` during `Runtime.configure()` call

**Typical Contents:**
```dockerfile
FROM public.ecr.aws/docker/library/python:3.11-slim

WORKDIR /app

# Install uv for faster package management
RUN pip install uv

# Copy and install requirements
COPY requirements.txt .
RUN uv pip install -r requirements.txt

# Set environment variables
ENV DOCKER_CONTAINER=1

# Copy application code
COPY . .

# Run the agent
CMD ["python", "-m", "agent.weather_time_agent"]
```

**Usage:**
- Used by Docker during container build process
- Automatically generated based on `requirements.txt` and agent configuration
- Modified based on whether Braintrust observability is enabled

**Important Notes:**
- **Auto-generated - do not commit to version control**
- Regenerated on every deployment
- Stored in `tobedeleted/` folder
- The toolkit generates different Dockerfiles based on configuration:
  - CloudWatch only: Standard runtime
  - Braintrust enabled: No separate OTEL instrumentation wrapper

**Generation Process:**
The starter toolkit generates this file in `Runtime.configure()`:
```python
agentcore_runtime.configure(
    entrypoint="agent/weather_time_agent.py",
    requirements_file="requirements.txt",
    disable_otel=True  # When Braintrust is enabled
)
# Dockerfile is auto-generated based on configuration
```

---

### `.dockerignore`
**Location:** Tutorial root (`simple-dual-observability/.dockerignore`)

**Purpose:** Specifies files and directories to exclude from the Docker build context, reducing image size and build time.

**Generated By:** `bedrock-agentcore-starter-toolkit` during `Runtime.configure()` call

**Typical Contents:**
```
.git
.gitignore
.venv
__pycache__
*.pyc
*.pyo
*.pyd
.pytest_cache
.mypy_cache
.ruff_cache
docs/
tests/
scripts/
.env
.env.*
*.md
```

**Usage:**
- Read by Docker during `docker build` to exclude files
- Prevents sensitive files and unnecessary content from being copied into container
- Reduces Docker image size

**Important Notes:**
- **Auto-generated - do not commit**
- Regenerated on every deployment
- Stored in `tobedeleted/` folder
- Standard exclusions for Python projects

**Generation Process:**
Auto-generated by starter toolkit alongside Dockerfile during `Runtime.configure()`

---

## File Lifecycle

### During Deployment (`scripts/deploy_agent.sh`)
1. `.bedrock_agentcore.yaml` - Created/updated by toolkit
2. `Dockerfile` - Generated by toolkit
3. `.dockerignore` - Generated by toolkit
4. `.deployment_metadata.json` - Created after successful deployment

### During Braintrust Setup (`scripts/setup_braintrust.sh`)
1. `.env.backup` - Created if `.env` exists
2. `.env` - Updated with Braintrust credentials (if not using CLI args)

### During Cleanup (`scripts/cleanup.sh`)
1. `.deployment_metadata.json` - Deleted
2. `.bedrock_agentcore.yaml` - Optionally deleted

---

## Best Practices

### Version Control
- **Never commit** `.env` files (contain secrets)
- **Never commit** `.deployment_metadata.json` (deployment-specific)
- **Never commit** auto-generated files (`Dockerfile`, `.dockerignore`)
- **Do commit** `.gitignore` to prevent accidental commits

### Security
- Store `.env` files outside of version control
- Use AWS Secrets Manager or Parameter Store for production
- Rotate API keys regularly
- Never share `.env` files in public channels

### Cleanup
- Delete generated files when switching between environments
- Use `scripts/cleanup.sh` to remove deployment artifacts
- Keep `tobedeleted/` folder for reference but not committed

### Recovery
- Keep backups of `.env` files in secure location
- Document Braintrust project IDs externally
- `.deployment_metadata.json` can be regenerated by redeploying

---

## Troubleshooting

### Missing .deployment_metadata.json
**Symptom:** Scripts fail with "No deployment metadata found"

**Solution:** Redeploy the agent:
```bash
scripts/deploy_agent.sh
```

### Lost .env file
**Symptom:** Braintrust credentials not found

**Solution:**
1. Check for `.env.backup` in `scripts/`
2. Retrieve API key from Braintrust dashboard
3. Recreate `.env` file

### Stale .bedrock_agentcore.yaml
**Symptom:** Deployment uses old configuration

**Solution:** Delete the file and redeploy:
```bash
rm .bedrock_agentcore.yaml
scripts/deploy_agent.sh
```

### Docker build fails
**Symptom:** "No such file or directory" during build

**Solution:** Regenerate Dockerfile:
```bash
# Delete old files
rm Dockerfile .dockerignore

# Redeploy (will regenerate files)
scripts/deploy_agent.sh
```

---

## See Also

- [Main README](../README.md) - Tutorial overview and setup
- [Troubleshooting Guide](troubleshooting.md) - Common issues and solutions
- [Development Guide](development.md) - Local testing and development
